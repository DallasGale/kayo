---
import Form from "../../components/form/";
import Layout from "../../layouts/layout.astro";
import Button from "../../components/button/index.astro";
---

<Layout title="Kayo - Submit">
  <header>
    <Button label="Back" isDark link="/" />
  </header>

  <Form client:load successCb={() => console.log("success form astro")} />

  <div id="lottie-container"></div>
</Layout>

<script>
  import lottie from "lottie-web";
  import animationData from "../../assets/lotti/confetti.json";

  document.addEventListener("statusChange", (event) => {
    const status = (event as CustomEvent).detail.status;

    const lottieContainer: HTMLElement | null =
      document.getElementById("lottie-container");
    // Update the page based on status
    if (status === "success" && lottieContainer !== null) {
      // Initialize lottie animation
      lottie.loadAnimation({
        container: lottieContainer,
        renderer: "svg",
        loop: false,
        autoplay: true,
        animationData: animationData,
      });
    } else {
      console.log("no success");
    }
  });
</script>
<style>
  header {
    box-sizing: border-box;
    padding: 40px;
    max-width: 1440px;
    position: absolute;
    width: 100%;
    left: 0;
    right: 0;
    margin: auto;
    z-index: 2;
  }

  #lottie-container {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 3;
    pointer-events: none;
  }
</style>
